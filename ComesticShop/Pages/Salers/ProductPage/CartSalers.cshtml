@page
@model ComesticShop.Pages.Salers.ProductPage.CartSalersModel
@{
}
@if (@Model.Role == "2")
{
    @if (ViewBag.ErrorMessage != null)
    {
        <div class="alert alert-danger text-center" role="alert">
            @ViewBag.ErrorMessage
        </div>
    }
        <table border="1" class="table table-hover" style="border: 1px solid black">
            <tr>
                <th>Code</th>
                <th>Name</th>
                <th>Quantity</th>
                <th>Total</th>
                <th>Delete</th>
                <th>Action</th>
            </tr>
            @if (@Model.cartSaler == null)
            {
                <p style="color:red">Giỏ hàng không có sản phẩm</p>
            }
            else
            {
                @foreach (var item in Model.cartSaler)
                {
                    Model.Total += item.Product.Price * item.Quantity;
                    <tr>
                        <td>@item.Product.Code</td>
                        <td>@item.Product.Name</td>
                        <td>@item.Quantity</td>
                        <td>@(item.Product.Price * item.Quantity)</td>
                        <td>
                            <a asp-page="cartSalers" asp-page-handler="delete" asp-route-id="@item.Product.Id">X</a>
                        </td>
                        <td>
                            <a class="btn btn-outline-secondary" asp-page="cartSalers" asp-page-handler="increase" asp-route-id="@item.Product.Id"><i class="fas fa-fw fa-plus"></i></a>
                            <a class="btn btn-outline-secondary" asp-page="cartSalers" asp-page-handler="decrease" asp-route-id="@item.Product.Id"><i class="fas fa-fw fa-minus"></i></a>
                        </td>
                    </tr>
                }
            
                <tr>
                    <td colspan="3" align="center">
                        Total
                    </td>
                    <td>
                        @Model.Total
                    </td>
                </tr>
        }
        </table>
        
        
        <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
            <div class="btn-group" role="group" aria-label="First group">
                <a asp-page="./Index" class="btn btn-primary" style="text-align:center;font-size:20px">Trở về danh sách sản phẩm</a>
            </div>
            <div class="input-group">
                <form method="post">
                    @if (Model.cartSaler == null)
                                    {
                                        <input type="text" name="SubTotal" value="@Model.Total" hidden />
                                        <button asp-for="@Model.Total" type="submit" class="btn btn-dark btn-block btn-lg"
                                                data-mdb-ripple-color="dark" disabled>
                                            Thanh toán
                                        </button>
                                    }
                                    else
                                    {
                                        <input type="text" name="SubTotal" value="@Model.Total" hidden />
                                        <button asp-for="@Model.Total" type="submit" class="btn btn-dark btn-block btn-lg"
                                                data-mdb-ripple-color="dark">
                                            Thanh toán
                                        </button>
                                    }
                </form>
            </div>
        </div>
    


}
else
{
    Response.Redirect("/Authenticate/Login");
}